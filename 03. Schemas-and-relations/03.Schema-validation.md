# Schema validation

- Though mongoDB is very flexible and schemaless in general, Sometimes we want our documents to have a rigid structure.
- While inserting or updating documents into a collection, if the passed data does not obey the schema rules defined, it should throw an error.

```ts
db.createCollection('name', { validator: {} })
```

- Every document that is bieng inserted is validated against a schema.
- For array and nested objects we again use the same properties as we will sue in top level.

```ts
db.createCollection("users", {
  validator: {
    $jsonSchema: {
      bsonType: "object",
      required: [
        "id",
        "name",
        "username",
        "email",
        "phone",
        "website",
        "company",
        "address",
      ],
      properties: {
        id: {
          bsonType: "int",
          description: "ID should be a valid number",
        },
        name: {
          bsonType: "string",
          description: "Name should be a valid string",
        },
        username: {
          bsonType: "string",
          description: "username should be a valid string",
        },
        email: {
          bsonType: "string",
          description: "email should be a valid string",
        },
        phone: {
          bsonType: "string",
          description: "phone should be a valid string",
        },
        website: {
          bsonType: "string",
          description: "website should be a valid string",
        },
        company: {
          bsonType: "object",
          required: ["name", "catchPhrase", "bs"],
          properties: {
            name: {
              bsonType: "string",
              description: "Name should be a valid string",
            },
            catchPhrase: {
              bsonType: "string",
              description: "catchPhrase should be a valid string",
            },
            bs: {
              bsonType: "string",
              description: "bs should be a valid string",
            },
          },
        },
        address: {
          bsonType: "object",
          required: ["street", "suite", "city", "zipcode", "geo"],
          properties: {
            street: {
              bsonType: "string",
              description: "Should be a valid string",
            },
            suite: {
              bsonType: "string",
              description: "Should be a valid string",
            },
            city: {
              bsonType: "string",
              description: "Should be a valid string",
            },
            zipcode: {
              bsonType: "string",
              description: "Should be a valid string",
            },
            geo: {
              bsonType: "object",
              required: ["lat", "lng"],
              properties: {
                lat: {
                  bsonType: "string",
                  description: "Should be a valid string",
                },
                lng: {
                  bsonType: "string",
                  description: "Should be a valid string",
                },
              },
            },
          },
        },
      },
    },
  },
});

```

[List of valid bson types](https://www.mongodb.com/docs/manual/reference/operator/query/type/#std-label-document-type-available-types)
